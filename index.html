<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxury Fashion Data Story</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <!-- Custom Cursor -->
    <div id="cursor"></div>
    <div id="cursor-follower"></div>

    <!-- Slide Navigation -->
    <div class="slide-nav">
        <div class="nav-dot active" data-slide="Intro" onclick="scrollToSlide(0)"></div>
        <div class="nav-dot" data-slide="Heritage" onclick="scrollToSlide(1)"></div>
        <div class="nav-dot" data-slide="Timeline" onclick="scrollToSlide(2)"></div>
        <div class="nav-dot" data-slide="Brands" onclick="scrollToSlide(3)"></div>
        <div class="nav-dot" data-slide="Insights" onclick="scrollToSlide(4)"></div>
        <div class="nav-dot" data-slide="Market Today" onclick="scrollToSlide(5)"></div>
        <div class="nav-dot" data-slide="Overview" onclick="scrollToSlide(6)"></div>
        <div class="nav-dot" data-slide="Traffic" onclick="scrollToSlide(7)"></div>
        <div class="nav-dot" data-slide="Market Insights" onclick="scrollToSlide(8)"></div>
        <div class="nav-dot" data-slide="Products" onclick="scrollToSlide(9)"></div>
        <div class="nav-dot" data-slide="Best Sellers" onclick="scrollToSlide(10)"></div>
        <div class="nav-dot" data-slide="Distribution" onclick="scrollToSlide(11)"></div>
        <div class="nav-dot" data-slide="Product Insights" onclick="scrollToSlide(12)"></div>
        <div class="nav-dot" data-slide="Resale" onclick="scrollToSlide(13)"></div>
        <div class="nav-dot" data-slide="Resale Market" onclick="scrollToSlide(14)"></div>
        <div class="nav-dot" data-slide="Vestiaire" onclick="scrollToSlide(15)"></div>
        <div class="nav-dot" data-slide="Resale Insights" onclick="scrollToSlide(16)"></div>
        <div class="nav-dot" data-slide="Thanks" onclick="scrollToSlide(17)"></div>
        <div class="nav-dot" data-slide="Team" onclick="scrollToSlide(18)"></div>
    </div>

    <!-- EMPTY container: slides will be injected by slides/*.js -->
    <div class="scroll-container"></div>

    <!-- Load slide modules (inject HTML into .scroll-container) -->
    <script src="slides/slide1.js"></script>
    <script src="slides/slide2.js"></script>
    <script src="slides/slide3.js"></script>
    <script src="slides/slide4.js"></script>
    <script src="slides/slide5.js"></script>
    <script src="slides/slide6.js"></script>
    <script src="slides/slide7.js"></script>
    <script src="slides/slide8.js"></script>
    <script src="slides/slide9.js"></script>
    <script src="slides/slide10.js"></script>
    <script src="slides/slide11.js"></script>
    <script src="slides/slide12.js"></script>
    <script src="slides/slide13.js"></script>
    <script src="slides/slide14.js"></script>
    <script src="slides/slide15.js"></script>
    <script src="slides/slide16.js"></script>
    <script src="slides/slide17.js"></script>
    <script src="slides/slide18.js"></script>
    <script src="slides/slide19.js"></script>

    <!-- Tooltip -->
    <div class="tooltip"></div>

    <script>
        // Custom Cursor
        const cursor = document.getElementById('cursor');
        const cursorFollower = document.getElementById('cursor-follower');

        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
            
            setTimeout(() => {
                cursorFollower.style.left = e.clientX + 'px';
                cursorFollower.style.top = e.clientY + 'px';
            }, 100);
        });

        document.addEventListener('mousedown', () => {
            cursor.classList.add('active');
        });

        document.addEventListener('mouseup', () => {
            cursor.classList.remove('active');
        });

        // Scroll Navigation
        function scrollToSlide(index) {
            const allSlides = document.querySelectorAll('.slide');
            allSlides[index].scrollIntoView({ behavior: 'smooth' });
        }

        // Update navigation dots on scroll
        const scrollContainer = document.querySelector('.scroll-container');
        const navDots = document.querySelectorAll('.nav-dot');

        scrollContainer.addEventListener('scroll', () => {
            const scrollPosition = scrollContainer.scrollTop;
            const windowHeight = window.innerHeight;
            const allSlides = document.querySelectorAll('.slide');

            allSlides.forEach((slide, index) => {
                const slideTop = slide.offsetTop;
                const slideBottom = slideTop + slide.offsetHeight;

                if (scrollPosition >= slideTop - windowHeight / 2 && scrollPosition < slideBottom - windowHeight / 2) {
                    navDots.forEach(dot => dot.classList.remove('active'));
                    navDots[index].classList.add('active');

                    // Trigger slide content animation
                    const content = slide.querySelector('.slide-content');
                    if (content && !content.classList.contains('visible')) {
                        content.classList.add('visible');
                    }
                }
            });
        });

        // Initialize first slide
        setTimeout(() => {
            const firstContent = document.querySelector('.slide-content');
            if (firstContent) firstContent.classList.add('visible');
        }, 100);

        // Shared data
        window.brandColors = {
            "Hermès": "#8B2635",
            "Gucci": "#d4af37",
            "Coach": "#8b4513"
        };

        window.revenueData = [
            {Year: 2012, "Hermès": 4128, Gucci: 3790, Coach: 910},
            {Year: 2013, "Hermès": 4435, Gucci: 4230, Coach: 970},
            {Year: 2014, "Hermès": 4832, Gucci: 4550, Coach: 940},
            {Year: 2015, "Hermès": 5108, Gucci: 4950, Coach: 940},
            {Year: 2016, "Hermès": 6135, Gucci: 5439, Coach: 940},
            {Year: 2017, "Hermès": 6701, Gucci: 6883, Coach: 1010},
            {Year: 2018, "Hermès": 7035, Gucci: 8594, Coach: 1040},
            {Year: 2019, "Hermès": 7709, Gucci: 10192, Coach: 1060},
            {Year: 2020, "Hermès": 7295, Gucci: 17630, Coach: 1080},
            {Year: 2021, "Hermès": 10626, Gucci: 15599, Coach: 1100},
            {Year: 2022, "Hermès": 12219, Gucci: 18110, Coach: 1120},
            {Year: 2023, "Hermès": 14535, Gucci: 17839, Coach: 1140},
            {Year: 2024, "Hermès": 16414, Gucci: 14864, Coach: 1170}
        ];

        window.resaleData = [
            {brand: "Coach", category: "Accessories", count: 1627, mean: 104.74},
            {brand: "Coach", category: "Apparel", count: 210, mean: 245.97},
            {brand: "Coach", category: "Shoes", count: 427, mean: 116.26},
            {brand: "Gucci", category: "Accessories", count: 17914, mean: 313.82},
            {brand: "Gucci", category: "Apparel", count: 6668, mean: 688.45},
            {brand: "Gucci", category: "Shoes", count: 17533, mean: 498.12},
            {brand: "Hermès", category: "Accessories", count: 12431, mean: 621.87},
            {brand: "Hermès", category: "Apparel", count: 2247, mean: 1181.56},
            {brand: "Hermès", category: "Shoes", count: 5084, mean: 567.15}
        ];

        // Initialize visualizations when slides become visible
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const slideContent = entry.target.querySelector('.slide-content');
                    if (slideContent && !slideContent.classList.contains('visible')) {
                        slideContent.classList.add('visible');
                    }

                    if (entry.target.classList.contains('slide-3') && !entry.target.dataset.initialized) {
                        if (window.createBrandTimeline) window.createBrandTimeline();
                        entry.target.dataset.initialized = true;
                    }
                    if (entry.target.classList.contains('slide-6') && !entry.target.dataset.initialized) {
                        if (window.createOverviewChart) window.createOverviewChart();
                        entry.target.dataset.initialized = true;
                    }
                    if (entry.target.classList.contains('slide-7') && !entry.target.dataset.initialized) {
                        if (window.createGlobalTrafficViz) window.createGlobalTrafficViz();
                        entry.target.dataset.initialized = true;
                    }
                    if (entry.target.classList.contains('slide-9') && !entry.target.dataset.initialized) {
                        if (window.loadProducts) window.loadProducts();
                        entry.target.dataset.initialized = true;
                    }
                    if (entry.target.classList.contains('slide-10') && !entry.target.dataset.initialized) {
                        if (window.createDistributionChart) window.createDistributionChart();
                        entry.target.dataset.initialized = true;
                    }
                    if (entry.target.classList.contains('slide-12') && !entry.target.dataset.initialized) {
                        if (window.createResaleChart) window.createResaleChart();
                        entry.target.dataset.initialized = true;
                    }
                    if (entry.target.classList.contains('slide-vestiaire') && !entry.target.dataset.initialized) {
                        if (window.createVestiaireViz) window.createVestiaireViz();
                        entry.target.dataset.initialized = true;
                    }
                }
            });
        }, { threshold: 0.3 });

        const observedSlides = document.querySelectorAll('.slide');
        observedSlides.forEach(slide => observer.observe(slide));
    </script>
</body>
</html>
